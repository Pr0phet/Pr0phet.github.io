<!DOCTYPE html>
<html lang="pt">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Web狗要懂的CBC翻转字节攻击(Flipped Ciphertext Bits) | Pr0ph3t's blog</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="/assets/css/bootstrap-3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-69613510-1', 'auto');
    ga('send', 'pageview');

</script>


    <link rel="shortcut icon" href="/assets/images/favicon.png">

    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed/"> 

</head>


    <body>
      <div class="container">

        <header class="row">
  <div class="col-lg-8 col-lg-offset-2">
    <h1 class="">Pr0ph3t</h1>
    <p>
    <span class="reserved">char</span> nick[<span class="number">9</span>] = <span class="string">"Pr0ph3t"</span>;
    </p>
    <p>
    printf(<a href="https://github.com/t3hp0rP" target="_blank"><span class="string">"https://github.com/<span class="reserved">%s\n</span>"</span></a>,nick);
    </p>
    <p>
    printf(<span class="string">"<span class="reserved">%s\x40</span>pr0ph3t<span class="reserved">\x2e\\\b</span>com<span class="reserved">\n</span>"</span>,<span class="string">"admin"</span>);
    </p>
    <!-- <p>
            printf(<a href="https://blog.pr0ph3t.com" target="_blank"><span class="string">"https://<span class="reserved">%s</span>.pr0ph3t.com<span class="reserved">\n</span>"</span></a>,nick);
        </p> -->
    <p>
    puts(<a href="/assets/misc/pubkey.gpg.txt" target="_blank"><span class="string">"91B6 191A C2C3 285C 201D  801B B5A3 6B56 8528 E140"</span></a>);
    </p>
  </div>
</header>

<div class="row">
  <div class="col-lg-8 col-lg-offset-2">
    <div class="menu">
      <ul>
          <li><a href="/">home</a></li>
          <li><a href="/articles/">articles</a></li>
          <li><a href="/friendlink">friends</a></li>
      </ul>
    </div>
  </div>
</div>



        <div class="row">
          <div class="col-lg-8 col-lg-offset-2">
            <main>
            <div class="post">

  <header class="post-header">
    <h1>Web狗要懂的CBC翻转字节攻击(Flipped Ciphertext Bits)</h1>
  </header>

  <article class="post-content">
  <div class="post">

  <header class="post-header">
    <p class="meta">
        Oct 24, 2017
        
        
        •
        <span><a href="/category/#CyberSecurity" class="reserved">CyberSecurity</a>,</span><span><a href="/category/#writeup" class="reserved">writeup</a>,</span><span><a href="/category/#crypto" class="reserved">crypto</a>,</span><span><a href="/category/#old" class="reserved">old</a></span>
    </p>
  </header>

  <article class="post-content">
  <p>这次蓝盾杯线上赛遇到了一题类似于NJCTF的CBC翻转攻击的题目，不过题目被改简单了，省去了最开始的Padding Oracle攻击部分，直接给出了初始字符串。<br>
源码如下：</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span> 
<span class="nb">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s2">"METHOD"</span><span class="p">,</span> <span class="s2">"aes-128-cbc"</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s2">"SECRET_KEY"</span><span class="p">,</span> <span class="s2">"XXXXX"</span><span class="p">);</span>
<span class="nv">$flag</span> <span class="o">=</span> <span class="s2">"flag</span><span class="si">{</span><span class="nv">...</span><span class="si">}</span><span class="s2">"</span><span class="p">;</span>
<span class="nb">session_start</span><span class="p">();</span>

<span class="k">function</span> <span class="nf">get_random_token</span><span class="p">(){</span>
    <span class="nv">$random_token</span><span class="o">=</span><span class="s1">''</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
        <span class="nv">$random_token</span><span class="o">.=</span><span class="nb">chr</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">255</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$random_token</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">get_identity</span><span class="p">()</span>
<span class="p">{</span>
 <span class="nv">$defaultID</span> <span class="o">=</span> <span class="s2">"heheda"</span><span class="p">;</span>
 <span class="nv">$token</span> <span class="o">=</span> <span class="nx">get_random_token</span><span class="p">();</span>
    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">openssl_encrypt</span><span class="p">(</span><span class="nv">$defaultID</span><span class="p">,</span> <span class="nx">METHOD</span><span class="p">,</span> <span class="nx">SECRET_KEY</span><span class="p">,</span> <span class="nx">OPENSSL_RAW_DATA</span><span class="p">,</span> <span class="nv">$token</span><span class="p">));</span>
    <span class="nb">setcookie</span><span class="p">(</span><span class="s2">"token"</span><span class="p">,</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$token</span><span class="p">));</span>
    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'isadmin'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">is_admin</span><span class="p">()</span>
<span class="p">{</span>
 <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'id'</span><span class="p">])){</span>
  <span class="nv">$token</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">'token'</span><span class="p">]);</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$id</span> <span class="o">=</span> <span class="nb">openssl_decrypt</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]),</span> <span class="nx">METHOD</span><span class="p">,</span> <span class="nx">SECRET_KEY</span><span class="p">,</span> <span class="nx">OPENSSL_RAW_DATA</span><span class="p">,</span> <span class="nv">$token</span><span class="p">)){</span>
   <span class="k">if</span><span class="p">(</span><span class="nv">$id</span> <span class="o">==</span> <span class="s2">"admin"</span><span class="p">)</span>
    <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'isadmin'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
   <span class="k">die</span><span class="p">(</span><span class="s2">"Error!"</span><span class="p">);</span>
  <span class="p">}</span>
 <span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]))</span>
    <span class="nx">get_identity</span><span class="p">();</span>
<span class="k">else</span> <span class="p">{</span>
 <span class="nx">is_admin</span><span class="p">();</span>
 <span class="k">if</span> <span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s2">"isadmin"</span><span class="p">]){</span>
     <span class="k">echo</span> <span class="s2">"You are admin!</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
     <span class="k">die</span><span class="p">(</span><span class="nv">$flag</span><span class="p">);</span>
 <span class="p">}</span><span class="k">else</span>
     <span class="k">echo</span> <span class="s2">"You are not admin!</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>

 <span class="cp">?&gt;</span>
</code></pre></div>
<p>先上脚本</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">base64</span> <span class="k">as</span> <span class="n">b64</span>
<span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">source_str</span> <span class="o">=</span> <span class="s">'heheda'</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="s">'</span><span class="se">\x0a</span><span class="s">'</span>
<span class="n">target_srt</span> <span class="o">=</span> <span class="s">'admin'</span> <span class="o">+</span> <span class="mi">11</span> <span class="o">*</span> <span class="s">'</span><span class="se">\x0b</span><span class="s">'</span>
<span class="n">token</span> <span class="o">=</span> <span class="s">'ooeOFlWe26ZCTl8nVzCd2Q=='</span> <span class="c1">#你获得的初始IV的base64encode值
</span><span class="n">token</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">b64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">token</span><span class="p">))</span>
<span class="c1"># token[0] = chr(ord('h') ^ ord('a') ^ ord(token[0]))
# print token
# exit()
</span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">target_srt</span><span class="p">)):</span>
    <span class="n">token</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">token</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">target_srt</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">source_str</span><span class="p">[</span><span class="n">x</span><span class="p">]))</span>
<span class="k">print</span> <span class="n">b64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="s">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">token</span><span class="p">))</span>
</code></pre></div>
<p>这里我们可控的只有解密的初始向量IV 下面是介绍这个加密方法的原理：</p>

<hr>

<h2 id="part-2b9bf298b7322cd6">加密过程</h2>

<p><img src="/assets/images/posts/2017/Web%E7%8B%97%E8%A6%81%E6%87%82%E7%9A%84CBC%E7%BF%BB%E8%BD%AC%E5%AD%97%E8%8A%82%E6%94%BB%E5%87%BB-Flipped-Ciphertext-Bits/1.png" alt="加密过程"></p>

<ol>
<li>首先将明文分成每X位一组，位数不足的是用特殊字符填充  ！！！！！！！
X常见的为16位，也有32位
这里要注意，CBC的填充规则是缺少N位，就用 N 个 &#39;\xN&#39;填充，如缺少10位则用 10 个 &#39;\x10&#39;填充</li>
<li>然后生成初始向量IV(这里的初始向量如果未特定给出则随机生成)和密钥</li>
<li>将初始向量与第一组明文异或生成密文A</li>
<li>用密钥加密密文A 得到密文A_1</li>
<li>重复3 将密文A_1与第二组明文异或生成密文B</li>
<li>重复4 用密钥加密密文B_1</li>
<li>重复3-6 直到最后一组明文</li>
<li>将IV和加密后的密文拼接在一起，得到最终的密文</li>
</ol>

<h2 id="part-2e54ec7d71ac80b9">解密过程</h2>

<p><img src="/assets/images/posts/2017/Web%E7%8B%97%E8%A6%81%E6%87%82%E7%9A%84CBC%E7%BF%BB%E8%BD%AC%E5%AD%97%E8%8A%82%E6%94%BB%E5%87%BB-Flipped-Ciphertext-Bits/2.png" alt="解密过程"></p>

<ol>
<li>首先从最终的密文中提取出IV (IV为加密时指定的X位)</li>
<li>将密文分组</li>
<li>使用密钥对第一组密文解密得到密文A，然后用IV进行异或得到第一组明文</li>
<li>使用密钥对第二组密文解密得到密文B，然后用A与B进行异或得到第二组明文</li>
<li>重复3-4 直到最后一组密文</li>
</ol>

<hr>

<p>所以根据以上过程，攻击点有两个，一个是初始向量IV，第二个是第N-1个密文。题目利用的是IV攻击的点</p>

<p>下面是攻击过程：<br>
根据解密过程，假设A为明文，B为前一组密文，C为密文经过密钥解密之后的字符串：</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$A</span> <span class="o">=</span> <span class="nx">Plaintext</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">11</span> <span class="p">;</span>
<span class="nv">$B</span> <span class="o">=</span> <span class="nx">Ciphertext</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">13</span> <span class="p">;</span>
<span class="nv">$C</span> <span class="o">=</span> <span class="nx">Decrypt</span><span class="p">(</span><span class="nx">Ciphertext</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span> <span class="p">;</span>
</code></pre></div>
<p>解密过程中我们是用 C与B 异或得到A， 即 <code class="prettyprint">C ^ B = A</code></p>

<p>题目这里只需要我们更改第一组明文的信息，所以我们只需要简单更改IV即可，<br>
即有以下过程：</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$A</span> <span class="o">=</span> <span class="nx">Plaintext</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'h'</span> <span class="p">;</span>
<span class="nv">$B</span> <span class="o">=</span> <span class="nx">IV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span>  <span class="nx">可控</span><span class="p">;</span>
<span class="nv">$C</span> <span class="o">=</span> <span class="nx">Decrypt</span><span class="p">(</span><span class="nx">Ciphertext</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">?</span><span class="p">;</span>

<span class="c1">//所以我们需要伪造一个新的IV向量，使得$C ^ New_IV = 我们需要的明文</span>
<span class="c1">//因为有 </span>
<span class="nv">$C</span> <span class="o">^</span> <span class="nx">Old_IV</span> <span class="o">=</span> <span class="nx">Source_str</span>
<span class="c1">//所以</span>
<span class="nv">$C</span> <span class="o">=</span> <span class="nx">Old_IV</span> <span class="o">^</span> <span class="nx">Source_str</span>
<span class="c1">//并且我们还需要</span>
<span class="nv">$C</span> <span class="o">^</span> <span class="nx">New_IV</span> <span class="o">=</span> <span class="nx">Target_str</span>
<span class="c1">//即</span>
<span class="nv">$C</span> <span class="o">=</span> <span class="nx">New_IV</span> <span class="o">^</span> <span class="nx">Target_str</span>
<span class="c1">//所以</span>
<span class="nx">Old_IV</span> <span class="o">^</span> <span class="nx">Source_str</span> <span class="o">=</span> <span class="nx">New_IV</span> <span class="o">^</span> <span class="nx">Target_str</span>
<span class="c1">//所以</span>
<span class="nx">New_IV</span> <span class="o">=</span> <span class="nx">Old_IV</span> <span class="o">^</span> <span class="nx">Source_str</span> <span class="o">^</span> <span class="nx">Target_str</span>
</code></pre></div>
<hr>

<p>下面是密文攻击的点</p>

<p>假如已知异或之后的第N-1组密文(Decrypt之后的密文)，我们就可以通过字节翻转改变第N组明文</p>

<p>数学原理和前面一种攻击点类似</p>

<p>下面假设我们要更改第3组明文$Old_pt[1]为第2组明文，$Old_ct[1]为第2组密文，$Old_ct[2]为第3组密文</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$Plaintext</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s1">'comment1=wowsuch'</span><span class="p">,</span>
  <span class="s1">'%20CBC;userdata='</span><span class="p">,</span>
  <span class="s1">'*admin=true;come'</span><span class="p">,</span>
  <span class="s1">'nt2=%20suchsafe%'</span><span class="p">,</span>
  <span class="s1">'20very%20encrypt'</span><span class="p">,</span>
  <span class="s1">'wowww'</span>
<span class="p">];</span><span class="c1">//我们要使$Plaintext[2]中的*变成;</span>
<span class="c1">//密文全部已知并可控</span>
<span class="nv">$Old_pt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Plaintext</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'%20CBC;userdata='</span><span class="p">;</span>
<span class="nv">$Old_ct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Decrypt</span><span class="p">(</span><span class="nx">Ciphertext</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">已知</span> <span class="nx">并且我们攻击的点在这</span><span class="p">;</span>
<span class="nv">$Old_ct</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Decrypt</span><span class="p">(</span><span class="nx">Ciphertext</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nx">已知</span><span class="p">;</span>

<span class="c1">//所以我们需要伪造一个新的第2组密文，使得$Old_ct[2] ^ $New_ct[1] = 我们需要的明文</span>
<span class="c1">//因为有 </span>
<span class="nv">$Old_ct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$Old_ct</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$Old_pt</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="c1">//所以</span>
<span class="nv">$Old_ct</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$Old_ct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$Old_pt</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="c1">//并且还已知</span>
<span class="nv">$New_ct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$Old_ct</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$New_pt</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="c1">//即</span>
<span class="nv">$Old_ct</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$New_ct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$New_pt</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="c1">//所以</span>
<span class="nv">$Old_ct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$Old_pt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$New_ct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$New_pt</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="c1">//所以</span>
<span class="nv">$New_ct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$Old_ct</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$Old_pt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^</span> <span class="nv">$New_pt</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
</code></pre></div>
<hr>

<p>暂时不知道有啥特别用处的数学背景</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="nv">$C</span> <span class="o">^</span> <span class="nv">$C</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// &lt;====一式 （任何数和自己异或都为0）</span>
<span class="c1">//又因为</span>
<span class="nv">$A</span> <span class="o">=</span> <span class="nv">$B</span> <span class="o">^</span> <span class="nv">$C</span><span class="p">;</span>
<span class="c1">//所以有</span>
<span class="nv">$C</span> <span class="o">=</span> <span class="nv">$A</span> <span class="o">^</span> <span class="nv">$B</span><span class="p">;</span>
<span class="c1">//所以一式又可以写成</span>
<span class="nv">$A</span> <span class="o">^</span> <span class="nv">$B</span> <span class="o">^</span> <span class="nv">$C</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">//又因为任何数和0异或都为自身，所以有</span>
<span class="nv">$A</span> <span class="o">^</span> <span class="nv">$B</span> <span class="o">^</span> <span class="nv">$C</span> <span class="o">^</span> <span class="mi">3</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</code></pre></div>
<hr>

<p>作者水平有限 如有错误请指出 Orz</p>

<p>参考文章 : <a href="http://www.ifuryst.com/archives/CBC_bitflipping_attacks.html">http://www.ifuryst.com/archives/CBC_bitflipping_attacks.html</a></p>

  </article>

	<p class="feed-recomendation">
		Did you like the post? Subscribe to the <a href="/feed/">feed</a>.
	</p>

  <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'pr0ph3t';
    var disqus_config = function () {
        this.page.identifier = "/posts/Web%E7%8B%97%E8%A6%81%E6%87%82%E7%9A%84CBC%E7%BF%BB%E8%BD%AC%E5%AD%97%E8%8A%82%E6%94%BB%E5%87%BB-Flipped-Ciphertext-Bits/";
    };
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>




</div>

  </article>

</div>

            </main>
          </div>
        </div>

        <div class="row">
  <div class="col-lg-8 col-lg-offset-2">
    <footer>
      Thx!
    </footer>
  </div>
</div>
<script src="//code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
$(document).ready(function() {
	$("img").each(function() {
		var strA = "<a data-fancybox='gallery' href='" + this.src + "'></a>";
		$(this).wrapAll(strA);
    });
});
</script>
<!-- <script type="text/javascript" src="/assets/js/images.js"></script> -->

      </div>
    </body>
</html>
